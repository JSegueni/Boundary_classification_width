Figure 1: Workflow for TAD boundary classification and quantification. (i). Input: genome-wide chromatin contacts are determined from Hi-C data. (ii). TAD boundaries are identified using the Insulation Score (IS ), where cumulative interaction signal is calculated within a moving square along the diagonal in the Hi-C matrix (example: green, yellow and purple squares). TAD boundaries correspond to local minima in the graph (valleys) that reach below a predefined threshold (arrow). Whereas the depth of a valley can be interpreted as the local strength of insulation between TADs, the width of the valley reveals the size of the region that functions as the boundary. (iii). Quantification of the width of the boundaries using the second derivative of the IS (IS”). The depth and narrowness of the IS” is a quantitative proxy for valley size. (iv). Grouping of TAD boundary size using k-means clustering of the IS” allows the identification of three categories: narrow/intermediate/extended TAD boundaries. (v). Polymer modeling and simulations with boundary constraints to explore the interface between TADs and the inter-TAD contact dynamics of genomic regions at long distance.

Figure 2: Classification of TAD boundaries. (A) Examples of TAD boundaries with different patterns of insulation. Left: a narrow boundary between TADs. Middle: an intermediate boundary. Right: an extended boundary. Hi-C data is depicted above. Purple arrowheads indicate the position of the boundary and the blue and yellow rectangles indicate the up- and downstream domains. Below, tracks for the Hi-C insulation score, CTCF and Rad21 ChIP-seq signal and computationally inferred width of the boundaries (purple boxes; see below) are shown. (B) Relative insulation score (IS) in a zoomed-in window of +/- 100 kb from the boundaries shown in panel (a). (C) k -means clustering of TAD boundaries in mouse ESCs, based on the width of IS interval. Left: relative IS (signal; indicative of the width of the boundary). Middle: normalized first derivative of the IS (IS’ ), indicative of the discreteness of the IS at the boundary. Right: normalized second derivative of the IS (IS”), indicative of the steepness of the boundary. Using k -means clustering of IS”, three categories of insulation score intervals are extracted. Average signal for the three categories in a window of 100 kb up- and downstream of the boundaries is indicated on top and heatmaps for individual boundaries are depicted below. (D) Averaged Hi-C matrices for the three categories of TAD boundaries in a window of 250 kb up- and downstream of the boundaries. (E) Average IS and derivatives for the three categories of TAD boundaries in a zoomed-out window of of +/- 250 kb from the boundaries.

Figure 3: Optimal reconstruction of RCL polymer models to account for the three TAD boundary categories. (A) Scheme of polymer representation of two TADs using two concatenated Randomly Cross-Linked (RCL) polymers [41]. Blue monomers belong to TAD 1 and red monomers to TAD 2. Black lines show the backbone connectivity, while yellow dashed lines indicate random connectors with uniform distributions. (B) Representation of a polymer with fixed random connectors at both sides of the boundary (connectors in green). (C) Representation of a polymer with a gap of Ngap monomers (green monomers; variable g) without random connectors separating the two TADs. (D) Representations of a polymer with a moving boundary position (monomers with mixed blue/red color; variable m). (E,F,G) Identification of the parameters that optimally reproduce the IS versus monomer location for the narrow, intermediate and extended boundaries.The matrix at the top shows error estimates, with the green box indicating the range of parameters that best reproduce the IS obtained from Hi-C data. The * indicates the intersection of parameters where the error estimates are lowest. All models incorporate fixed connectors at the boundary.

Figure 4: Average enrichment of chromatin and gene regulatory features around the three categories of TAD boundaries. (A) Average CTCF ChIP-seq signal. (B) Average Rad21 ChIP-seq signal. (C) Average accessible chromatin signal (ATAC-seq). (D) Average ongoing transcription signal (PRO-seq, with signal separated on the plus and minus strand). (E) Average number of TSSs within bins for each TAD boundary category. (F) (left) Fraction of deregulated TSS upon CTCF depletion among all TSS mapping within 100 kb from each TAD boundary category (CTCF-AID cells). (right) Fraction of up- and downregulated TSS upon CTCF depletion among all deregulated TSS within the bins (CTCF-AID cells). The origin of each dataset (mouse ESCs) indicated above the panel. Dashed lines represent the average genome-wide enrichment for each feature. Signal in panels (A-D) is binned to 10 kb and shown in a window of 100 kb up- and downstream of TAD boundaries. Signal in panel (E) is binned to the combined 10 kb up- and downstream of the boundary, and shown in a 100 kb window. Signal in panel (F) is binned to the combined 100 kb up- and downstream of the boundary. The gray bar indicates the genome average. Significance of difference between categories was determined using a G-test of independence.

Figure 5: Enrichment of CTCF binding features within inferred boundaries. (A) Outline of the strategy to infer the width of individual boundaries using the relative IS”. Individual boundaries extend from the center bin up to the first bin on either side that has a value below a cut-off that is defined as the average relative IS” value (IS”) within the 250 kb up- and downstream of all boundaries that were included in this study (dashed line). Coloured lines represent the average IS” signal (10 kb bins) for each category of boundaries, with shaded areas indicating the 10%-90% interval of the signal. (B) Histogram with the distribution of inferred width for individual boundaries in the three previously identified categories. (C) Visualization strategy for the spacing of CTCF features within and around extended boundaries. For all boundaries, signal in the two bins at the extremities (grey bins) and 5 first bins in the left and right TAD are determined. For boundaries that span 3 or more bins, the internal bins are proportionally divided over 2 (narrow boundaries) or 8 bins (intermediate and extended boundaries). For all resulting bins, the signal is normalized to the number of boundaries for each category, or to the boundaries that span 3 or more bins (for signal within the boundary). (D) Average number of CTCF peaks per bin within and around the inferred boundaries. (E) Average CTCF peak signal per bin within and around the inferred boundaries. (F) Average CTCF motif orientation bias per bin within and around the inferred boundaries. Bias is determined by substracting the average number of motifs in a positive orientation from the number of motifs in a negative orientation.

Figure 6: Effect of TAD boundary components on the gyration radius and TAD interface intermingling. (A) Two polymers connected by boundaries incorporating additional constraints. Intermingling at the interface (blue-red shading) is defined by the intersection of the two spheres at the center of mass with a radius equal to the radius of gyration. (B) Intermingling at the interface measured by the number of monomers that occupy the overlap between the spheres. Colored lines represent the combinations of added boundary components, relative to the number of random cross-linkers Nc.

Figure 7: Mean first encounter time (MFET). (A) Scheme for the mean first encounter time (MFET), defined as the first interaction time when the distance between two loci becomes smaller than a length ϵ between two monomers. (B) MFET ⟨τ ϵ 75,n⟩ for the uniform connectivity (i.e. two TADs defined only by random connectors with uniform distributions) with different numbers of random connectors Nc = 4, .., 12 obtained by averaging over 1000 polymer realizations. The black dotted line indicates the position of monomer 75 and the purple dotted line the boundary between TAD 1 (left) and TAD 2 (right). (C) MFET for connectivities with a fixed connector at the boundary (top), with a gap at the boundary (middle) and a heterogeneous boundary connection (bottom). (D) MFET for combined connectivities (fixed connector, gap and heterogeneous boundary).

Figure 8: Boundary interface defined by Average Mean Encounter. (A-C) Two TADs [1-100] and [101-200] are interacting with different type of connectors. Taking n=50, 100 and 150 as reference monomer. The three panels illustrate how mean encounter time ⟨τ ϵ m,n⟩ varies with the index position m. The mean encounter times ⟨τ ϵ m,n⟩tad1 (orange) and ⟨τ ϵm,n⟩tad2 (yellow band) change drastically when passing the boundary, showing how the boundary affects the encounter time between the two TADs. (D) Determination of the boundary interface using the average mean encounter. Monomers belonging to a given TAD (red or blue) show a nearly constant average mean encounter. A monomer belongs to the interface when this value falls outside a threshold defined by the standard deviation standard (orange) from the average (dashed green line). (E) Visualization of the classification depending on ⟨τ ϵm,n⟩tad1 and ⟨τ ϵm,n⟩tad2. (F) Boundary interface defined by the mean number of monomers ⟨N M F ET b ⟩ (black) versus number of connectors Nc for the different classes of connectivity. (G) Genome-wide Hi-C contacts for pairs of loci at varying genomic distances (10 kb resolution). Pairs of loci are classified for being within a TAD or being separated by a TAD boundary from one of the three categories. Arrows indicate genomic distances where boundary categories intersect. (H) Cartoon summarizing the impact of TAD boundary configuration on long-range TAD intermingling. The chromatin backbone in the TADs is indicated with the blue and red solid lines. Random connectors, representing extruding DNA loops, are indicated with yellow dashed lines. Fixed connectors, representing DNA loops that are blocked at the boundary, are indicated by green dashed lines. The potential for ectopic inter-TAD EP-loop formation is illustrated by the presence of an enhancer in TAD 1 and a promoter in TAD 2. The yellow star indicates the formation of a productive loop.

Figure S1: Principal component analysis of TAD boundaries with different widths. Visualization of the first and second principal component of the second derivative of the Insulation score IS” for the three boundary clusters as described in Fig. 2, which together make up nearly 68% of the variance. Although the contribution of the additional principal components is taken along in the k-means clustering approach as well, the three clusters already show a nearly complete separation on the x-axis.

Figure S2: Insulation scores for various parameter values. Calculation of the two-dimensional insulation score (IS ) vs monomer location, using a wide-range of parameters. (A) IS for models without a fixed connector at the boundary. (B) IS for models with a fixed connector at the boundary. Different panels represent the IS with an Ngap of different monomers at the boundary (Ngap = 0-5). Colored lines represent different values for the moving boundary position (variable m = 0-5). The black line indicares the average genome-wide IS at TAD boundaries, as obtained from Hi-C experiments.

Figure S3: Enrichment of chromatin and gene regulatory features in extended regions around the three clusters of TAD boundaries. (A) Average distribution of CTCF ChIP-seq signal. (B) Average distribution of Rad21 ChIP-seq signal. (C) Average distribution of accessible chromatin signal (ATAC-seq). (D) Average distribution of transcription signal (PRO-seq), with signal separated on the plus and minus strands. (E) Fraction of deregulated Transcriptional Start Sites (TSSs) among all TSSs within bins upon CTCF depletion (RNA-seq in 2-days Auxin-treated CTCF-AID cells). (F) Fraction of up- and downregulated TSSs among deregulated TSSs within bins upon CTCF depletion. The origin of the datasets, all from mouse ESCs, is indicated above each panel. Signal is binned to 10 kb, with dashed lines representing the average genome-wide enrichment. Signal in panels (A-D) is shown in a window of 250 kb up- and downstream of TAD boundaries. Signal in panels (E,F) is merged on both sides of the TAD boundaries and shown in a window up to 100 kb away from the boundaries. Significance of difference between categories for the same bin [panel (E,F)] and for the 0 kb bin versus the combined 10-100 kb bins within the same category [panel (F)] were determined using a G-test of independence.

Figure S4: Distribution of CTCF peak signal within inferred boundaries. Distribution of CTCF ChIP-seq signal (combined signal of all peaks in 10 kb bins) within the inferred boundaries in mouse ESCs for the different boundary categories.

Figure S5: Developmental dynamics of boundary width. (A) Pile-ups and heatmaps of the normalized insulation score IS and its normalized second derivative (IS”) in mouse mESCs, mouse Neural Progenitor Cells (mNPCs) and mouse Cortical Neurons (mCNs) around the TAD boundaries previously identified in mESCs. Average signal for the three categories in a window of 100 kb up- and downstream of the boundaries is indicated on top and heatmaps for individual boundaries are depicted below. (B) Examples of TAD boundaries with changes in insulation width between mESCs and mCNs, associated with reorganization of CTCF binding. Hi-C data is depicted above. Purple arrowheads indicate the position of the boundary in mESCs. Below, tracks for the Hi-C insulation score, CTCF peaks and computationally inferred width of the boundaries (purple boxes; see below) are shown. The arrow in the gene track for the right example indicates the Zfp42 gene, a pluripotency marker (also known as REX-1 in the human genome, whose activity is restricted to embryonic stem cells.

Figure S6: MFET for additional connectivities (A) MFET for a single RCL (i.e. a single polymer without internal separation) with different numbers of random connectors Nc = 4, .., 12 obtained averaging over 103 polymer realizations. The black dotted line indicates the position of monomer 75. The purple dotted line indicates monomer 100, which is the the boundary between TAD 1 (left) and TAD 2 (right) in the other connectivities. (B) MFET for a connectivity that combines a fixed connector and a gap at the boundary. (C) MFET for a connectivity that combines a fixed connector and a a heterogeneous connection at the boundary. (D) MFET for a connectivity that combines a gap and a a heterogeneous connection at the boundary.

Figure S7: MFET over larger distance and with increased numbers of cross-linkers. (A-I) MFET for the different connectivities as presented in Fig. 7 and Fig. S6, but with increased numbers of random connectors (Nc = 10, .., 100) and using monomer 25 as anchor. MFET was obtained averaging over 103 polymer realizations. The purple dotted line indicates monomer 100, which is the the boundary between TAD 1 (left) and TAD 2 (right) in the other connectivities.

Figure S8: Overlap of TAD boundaries with A/B compartments and distance from neighboring boundaries. (A) The location of TAD boundaries was scored relative to the position of Hi-C A/B compartments. The orange category represents TAD boundaries that overlap a transition between the A and B compartment. Significance of difference between the three categories was determined using a G-test of independence. Narrow boundaries are relatively enriched at the transition between A/B compartments, although the small size of this category means the number remains limited. Extended boundaries are relatively more enriched within the B-compartment. (B) Distribution of distances from neighboring boundaries for the different boundary categories. For all boundaries, both the distance to the nearest up- and downstream boundary was included.

